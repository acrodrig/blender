<h2>Blog Posts</h2>

<ul>
  {% for (var i = 0; i < items.length; i++) { %}
    <li>
      <a href="#:_posts/{{ items[i].name }}">{{ items[i].title }}</a>
      <span class="sub">(Published on {{ items[i].date }}, Size {{ items[i].humanSize }})</span></li>
  {% } %}
</ul>

<script>
  function humanSize(bytes) {
      if (bytes == 0) return "0.00 B";
      var exp = Math.floor(Math.log(bytes) / Math.log(1024));
      return (bytes/Math.pow(1024, exp)).toFixed(1)+' '+' KMGTP'.charAt(exp)+'B';
  }
  $.ajax({
      method: "GET",
      url: "https://api.github.com/repos/acrodrig/acrodrig.github.io/contents/_posts",
  }).done(function(data) {
      var items = _.map(data, function(item) {
          item.title = _.capitalize(item.name.split('.').shift().substring(11).replace(/-/g, ' '));
          item.date = item.name.split('.').shift().substring(0, 10);
          item.humanSize = humanSize(item.size);
          return item;
      });
      items = _.orderBy(items, "date", "desc");
      _.render(document.querySelector("main ul"), { items: items });
  });

  // Recalculate position
  navOrigTop = $("nav").offset().top;
</script>
